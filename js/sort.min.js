function shuffle(e){for(var t,n,a=e.length;a;)n=Math.floor(Math.random()*a--),t=e[a],e[a]=e[n],e[n]=t;return e}var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),flag=[],speed=1e3,timeout;window.onload=function(){canvas.width="600",canvas.height="600",document.getElementById("display").appendChild(canvas),buttonHandler()};var buttonHandler=function(){document.getElementById("run-button").onclick=function(){runSort()},document.getElementById("reset").onclick=function(){reset()};var e=document.getElementById("1X");e.disabled=!0,e.onclick=function(){setSpeed(1e3,0)},document.getElementById("2X").onclick=function(){setSpeed(500,1)},document.getElementById("4X").onclick=function(){setSpeed(250,2)},document.getElementById("Max").onclick=function(){setSpeed(100,3)}},generateList=function(e){for(var t=[],n=1;e>=n;n++)t.push(n);return shuffle(t),t},drawGraph=function(e,t){ctx.clearRect(0,0,canvas.width,canvas.height);for(var n=(canvas.width-20)/e.length,a=0;a<=e.length;a++)ctx.beginPath(),ctx.lineWidth=2,ctx.moveTo(n*(a+1),canvas.height),ctx.lineTo(n*(a+1),canvas.height-e[a]*n),ctx.strokeStyle=flag[0]!=a&&flag[1]!=a||!t?"#000000":"#ff0000",ctx.stroke()},runSort=function(){var e=document.getElementById("sort-size");switch(document.getElementById("choose-sort").disabled=!0,e.disabled=!0,document.getElementById("run-button").disabled=!0,document.getElementById("choose-sort").value){case"select":if(0==e.value){alert("Please choose a size!"),unlock();break}selectionSort(e.value);break;case"insert":if(0==e.value){alert("Please choose a size!"),unlock();break}insertionSort(e.value);break;case"merge":if(0==e.value){alert("Please choose a size!"),unlock();break}mergeSort(e.value);break;default:alert("Please choose an algorithm!"),unlock()}},setSpeed=function(e,t){for(var n=document.getElementsByClassName("speed"),a=0;a<n.length;a++)n[a].disabled=!1;n[t].disabled=!0,this.speed=e},reset=function(){clearTimeout(timeout),ctx.clearRect(0,0,canvas.width,canvas.height),list=[],flag=[],unlock()},unlock=function(){document.getElementById("choose-sort").disabled=!1,document.getElementById("sort-size").disabled=!1,document.getElementById("run-button").disabled=!1},swap=function(e,t,n){var a=e,o=a[t];return a[t]=a[n],a[n]=o,a},selectionSort=function(e){function t(){timeout=setTimeout(function(){for(var e=Number.MAX_VALUE,o=Number.MAX_VALUE,c=a;c<n.length;c++)n[c]<e&&(e=n[c],o=c);swap(n,a,o),flag=[a,o],drawGraph(n,!0),a++,a<n.length?t():(unlock(),drawGraph(n,!1))},speed)}var n=generateList(e);drawGraph(n,!1);var a=0;t()},insertionSort=function(e){function t(){timeout=setTimeout(function(){for(var e=n[a],o=a;o>0&&n[o-1]>e;o--)swap(n,o,o-1),flag=[o-1,o-1],drawGraph(n,!0);a++,a<n.length?t():(unlock(),drawGraph(n,!1))},speed)}var n=generateList(e);drawGraph(n,!1);var a=0;t()},mergeSort=function(e){function t(){timeout=setTimeout(function(){for(var e=0;e<n.length;e+=a)2==a?n[e]>n[e+1]&&(swap(n,e,e+1),drawGraph(n)):(n=merge(n,a/2,e),drawGraph(n));a*=2,a<2*n.length?t():unlock()},speed)}var n=generateList(e);console.log(n),drawGraph(n,!1);var a=2;t()},merge=function(e,t,n){var a=[];n>0&&(a=a.concat(e.splice(0,n)));var o=e.splice(0,t),c=e.splice(0,t);if(0!=e.length)var r=e.splice(0);else r=[];for(;0!=o.length&&0!=c.length;)a=a.concat(o[0]<=c[0]?o.splice(0,1):c.splice(0,1));for(;0!=o.length;)a=a.concat(o.splice(0,1));for(;0!=c.length;)a=a.concat(c.splice(0,1));return 0!=r.length&&(a=a.concat(r)),a};